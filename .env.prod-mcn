# RustDesk Server Configuration - PRODUCTION MCN SÉCURISÉ
# Environnement 2 : MCN (Réseau sécurisé, canalisé)
# ~2000 machines
# IMPORTANT: Firewall strict - UNIQUEMENT ports 21115-21119

# ============================================================================
# INFORMATIONS RÉSEAU
# ============================================================================

# Domaine du serveur (DNS interne MCN)
SERVER_DOMAIN=rustdesk-mcn.bh-systems.be

# IP du serveur ID/Rendezvous (hbbs)
HBBS_IP=172.20.0.100

# IP du serveur Relay (hbbr) - séparé pour sécurité
HBBR_PRIMARY_IP=172.20.0.101

# Relay Server
RELAY_SERVER=rustdesk-hbbr-mcn

# Subnet Docker (unique pour MCN)
DOCKER_SUBNET=172.22.0.0/24

# ============================================================================
# SÉCURITÉ RENFORCÉE (MCN)
# ============================================================================

# Clés secrètes - UTILISEZ DES VALEURS DIFFÉRENTES D'OFFICE !
# Générer avec: openssl rand -base64 32
POSTGRES_PASSWORD=CHANGE_ME_MCN_DB_PASSWORD_$(openssl rand -base64 16)
DB_URL=postgresql://rustdesk_admin:CHANGE_ME_MCN_DB_PASSWORD@postgres:5432/rustdesk_mcn

# Clés API (différentes de l'environnement Office)
API_SECRET_KEY=CHANGE_ME_MCN_API_SECRET_$(openssl rand -base64 32)
SESSION_SECRET=CHANGE_ME_MCN_SESSION_SECRET_$(openssl rand -base64 32)

# Active Directory / LDAP - Domaine MCN séparé
LDAP_ENABLED=true
LDAP_SERVER=ldap://ad-mcn.bh-systems.be:389
LDAP_BASE_DN=DC=mcn,DC=bh-systems,DC=be
LDAP_BIND_DN=CN=RustDesk Service MCN,OU=Service Accounts,DC=mcn,DC=bh-systems,DC=be
LDAP_BIND_PASSWORD=CHANGE_ME_LDAP_PASSWORD_MCN
LDAP_USER_FILTER=(objectClass=user)
LDAP_GROUP_FILTER=(objectClass=group)

# Restriction d'accès (groupes AD autorisés)
LDAP_ALLOWED_GROUPS=CN=MCN-Admins,OU=Groups,DC=mcn,DC=bh-systems,DC=be

# ============================================================================
# SSL/TLS Configuration
# ============================================================================

SSL_CERT_PATH=./certs/mcn/fullchain.pem
SSL_KEY_PATH=./certs/mcn/privkey.pem

# Forcer TLS 1.3 uniquement pour sécurité maximale
SSL_MIN_VERSION=TLSv1.3

# ============================================================================
# EMAIL (Notifications MCN)
# ============================================================================

SMTP_HOST=smtp.mcn.bh-systems.be
SMTP_PORT=587
SMTP_USER=rustdesk-mcn@bh-systems.be
SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD_MCN
SMTP_FROM=rustdesk-mcn@bh-systems.be

# ============================================================================
# PERFORMANCE (MCN ~2000 machines)
# ============================================================================

POSTGRES_DB=rustdesk_mcn
POSTGRES_USER=rustdesk_admin_mcn

MAX_CONNECTIONS=3000
WORKER_PROCESSES=4

# Logging détaillé pour audit
LOG_LEVEL=info
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=/var/log/rustdesk/audit-mcn.log

# ============================================================================
# FIREWALL - RÈGLES STRICTES
# ============================================================================
# AUTORISÉ:
#   21115 - hbbs TCP (NAT type test)
#   21116 - hbbs TCP/UDP (ID registration)
#   21117 - hbbr TCP (Relay)
#   21118 - hbbs TCP (Web socket)
#   21119 - hbbr TCP (Web socket)
#
# TOUT LE RESTE BLOQUÉ !
